{% extends 'base_restaurateur_page.html' %}

{% block title %}–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã | Star Burger{% endblock %}

{% block content %}
  <center>
    <h2>–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã</h2>
  </center>

  <hr/>
  <br/>
  <style>
    .comment-column {
      max-width: 120px;
      word-wrap: break-word;
    }
    .distance-info {
      font-size: 12px;
      color: #666;
      margin-top: 2px;
    }
    .no-restaurants {
      color: #dc3545;
      font-weight: bold;
    }
    .text-danger {
      color: #dc3545;
      font-weight: bold;
      padding: 5px;
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      border-radius: 4px;
    }
  </style>

  <div class="container">
   <table class="table table-responsive">
    <tr>
      <th>ID –∑–∞–∫–∞–∑–∞</th>
      <th>–°—Ç–∞—Ç—É—Å</th>
      <th>–ö–ª–∏–µ–Ω—Ç</th>
      <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
      <th>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</th>
      <th>–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</th>
      <th>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</th>
      <th>–°–æ–∑–¥–∞–Ω</th>
      <th>–ü–æ–∑–≤–æ–Ω–∏–ª–∏</th>
      <th>–î–æ—Å—Ç–∞–≤–ª–µ–Ω</th>
      <th>–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞</th>
      <th class="comment-column">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫–ª–∏–µ–Ω—Ç–∞</th>
      <th class="comment-column">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–∞</th>
      <th>–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞</th>
      <th>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</th>
    </tr>

    {% for order in orders %}
      <tr>
        <td>{{ order.id }}</td>
        <td>
          {% if order.status == '–ù–æ–≤—ã–π' %}
            <span class="label label-primary">{{ order.status }}</span>
          {% elif order.status == '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ' %}
            <span class="label label-warning">{{ order.status }}</span>
          {% elif order.status == '–ó–∞–≤–µ—Ä—à–µ–Ω' %}
            <span class="label label-success">{{ order.status }}</span>
          {% elif order.status == '–û—Ç–º–µ–Ω–µ–Ω' %}
            <span class="label label-danger">{{ order.status }}</span>
          {% else %}
            <span class="label label-default">{{ order.status }}</span>
          {% endif %}
        </td>
        <td>{{ order.firstname }} {{ order.lastname }}</td>
        <td>{{ order.phonenumber }}</td>
        <td>{{ order.address }}</td>
        <td>
          {% if order.cooking_restaurant %}
            <div class="selected-restaurant">
              ‚úÖ {{ order.cooking_restaurant.name }}
            </div>
          {% else %}
            {% if not order.is_address_found %}
              <!-- –ï—Å–ª–∏ –∞–¥—Ä–µ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω -->
              <div class="text-danger">
                ‚ùå –ê–¥—Ä–µ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
              </div>
            {% else %}
              {% if order.available_restaurants %}
                <div class="restaurant-info">
                  <strong>–ú–æ–≥—É—Ç –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å:</strong>
                  {% for restaurant_info in order.available_restaurants %}
                    <div class="available-restaurant">
                      ‚Ä¢ {{ restaurant_info.restaurant.name }}
                      {% if restaurant_info.distance is not None %}
                        <div class="distance-info">
                          üìç ~{{ restaurant_info.distance|floatformat:2 }} –∫–º
                        </div>
                      {% endif %}
                    </div>
                  {% endfor %}
                </div>
              {% else %}
                <div class="no-restaurants">
                  ‚ùå –ù–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
                </div>
              {% endif %}
            {% endif %}
          {% endif %}
        </td>
        <td>
          {% if order.payment_method == '–ù–∞–ª–∏—á–Ω—ã–º–∏' %}
            <span class="label label-info">üíµ {{ order.payment_method }}</span>
          {% elif order.payment_method == '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ' %}
            <span class="label label-success">üí≥ {{ order.payment_method }}</span>
          {% else %}
            <span class="label label-default">{{ order.payment_method }}</span>
          {% endif %}
        </td>
        <td>{{ order.created_at|date:"d.m.Y H:i" }}</td>
        <td>{{ order.called_at|date:"d.m.Y H:i"|default:"-" }}</td>
        <td>{{ order.delivered_at|date:"d.m.Y H:i"|default:"-" }}</td>
        <td><strong>{{ order.total_amount }} —Ä—É–±.</strong></td>
        <td class="comment-column">{{ order.comment|default:"-" }}</td>
        <td class="comment-column">{{ order.manager_comment|default:"-" }}</td>
        <td>
          <ul>
            {% for product in order.products %}
              <li>{{ product }}</li>
            {% endfor %}
          </ul>
        </td>
        <td>
          <a href="{% url 'admin:foodcartapp_order_change' order.id %}?next={{ request.path|urlencode }}">
            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
          </a>
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="15" class="text-center">–ù–µ—Ç –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</td>
      </tr>
    {% endfor %}
   </table>
  </div>
{% endblock %}
